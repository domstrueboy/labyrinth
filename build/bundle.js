var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function s(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function c(t){return null==t?"":t}function u(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function $(){return h(" ")}function g(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}let b;function v(t){b=t}function x(t){(function(){if(!b)throw new Error("Function called outside component initialization");return b})().$$.on_mount.push(t)}const w=[],A=[],_=[],z=[],k=Promise.resolve();let T=!1;function C(t){_.push(t)}const L=new Set;function E(){do{for(;w.length;){const t=w.shift();v(t),M(t.$$)}for(;A.length;)A.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];L.has(e)||(L.add(e),e())}_.length=0}while(w.length);for(;z.length;)z.pop()();T=!1,L.clear()}function M(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const H=new Set;let N;function j(){N={r:0,c:[],p:N}}function S(){N.r||r(N.c),N=N.p}function I(t,e){t&&t.i&&(H.delete(t),t.i(e))}function P(t,e,n,r){if(t&&t.o){if(H.has(t))return;H.add(t),N.c.push(()=>{H.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function B(t){t&&t.c()}function O(t,n,i){const{fragment:l,on_mount:s,on_destroy:c,after_update:u}=t.$$;l&&l.m(n,i),C(()=>{const n=s.map(e).filter(o);c?c.push(...n):r(n),t.$$.on_mount=[]}),u.forEach(C)}function R(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function q(t,e){-1===t.$$.dirty[0]&&(w.push(t),T||(T=!0,k.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(e,o,i,l,s,c,u=[-1]){const f=b;v(e);const a=o.props||{},d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:u};let p=!1;d.ctx=i?i(e,a,(t,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&s(d.ctx[t],d.ctx[t]=o)&&(d.bound[t]&&d.bound[t](o),p&&q(e,t)),n}):[],d.update(),p=!0,r(d.before_update),d.fragment=!!l&&l(d.ctx),o.target&&(o.hydrate?d.fragment&&d.fragment.l(function(t){return Array.from(t.childNodes)}(o.target)):d.fragment&&d.fragment.c(),o.intro&&I(e.$$.fragment),O(e,o.target,o.anchor),E()),v(f)}class F{$destroy(){R(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const V=[];function W(e,n=t){let r;const o=[];function l(t){if(i(e,t)&&(e=t,r)){const t=!V.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),V.push(n,e)}if(t){for(let t=0;t<V.length;t+=2)V[t][0](V[t+1]);V.length=0}}}return{set:l,update:function(t){l(t(e))},subscribe:function(i,s=t){const c=[i,s];return o.push(c),1===o.length&&(r=n(l)||t),i(e),()=>{const t=o.indexOf(c);-1!==t&&o.splice(t,1),0===o.length&&(r(),r=null)}}}}const G=W(!1),J=W([]),K=W(!1),Q=W(1);String.prototype.replaceAll=function(t,e){return this.split(t).join(e)};function U(e){let n,r;return{c(){n=p("div"),m(n,"contenteditable","true"),m(n,"class","wrapper svelte-1axfo0i"),m(n,"autofocus",""),void 0===e[1]&&C(()=>e[4].call(n))},m(t,o){f(t,n,o),e[3](n),void 0!==e[1]&&(n.innerHTML=e[1]),n.focus(),r=g(n,"input",e[4])},p(t,[e]){2&e&&t[1]!==n.innerHTML&&(n.innerHTML=t[1])},i:t,o:t,d(t){t&&a(n),e[3](null),r()}}}function X(t,e,n){let r,o,i;return l(t,G,t=>n(2,r=t)),t.$$.update=()=>{if(5&t.$$.dirty&&r){const t=o.innerHTML.replaceAll(/&nbsp;/gi,"").replaceAll("</div><div>",";").replaceAll("<div>",";").replaceAll("</div>","").replaceAll("<br>","delimeter").trim().split(";").map(t=>t.trim()).filter(t=>""!==t),e=t.reduce((t,e)=>{if("delimeter"===e)return t.push(e),t;const n=e.split(" ").filter(t=>""!==t),r=n[0].toLowerCase(),o=parseInt(n[1],10);return isNaN(o)?t:(["влево","left"].includes(r)?t.push(["left",o]):["вправо","right"].includes(r)?t.push(["right",o]):["вверх","up"].includes(r)?t.push(["up",o]):["вниз","down"].includes(r)?t.push(["down",o]):["повтор","повторить","repeat"].includes(r)&&t.push(["repeat",o]),t)},[]);console.log(e);const n=function(t){const e=t.length,n=[];let r=0;for(;r<e&&r<1e3;){const e=t[r];if(Array.isArray(e)){const o=e[0],i=e[1];if("repeat"===o){t[r+1]}for(let t=0;t<i;t++)n.push(o)}r++}return n}(e);console.log(n),J.set(n)}},[o,i,r,function(t){A[t?"unshift":"push"](()=>{n(0,o=t)})},function(){i=this.innerHTML,n(1,i)}]}class Y extends F{constructor(t){super(),D(this,t,X,U,i,{})}}function Z(e){let n,r;return{c(){n=p("div"),m(n,"class",r=c(e[3][e[0]])+" svelte-dkh07z"),y(n,"--size",e[1])},m(t,r){f(t,n,r),e[4](n)},p(t,[e]){1&e&&r!==(r=c(t[3][t[0]])+" svelte-dkh07z")&&m(n,"class",r),2&e&&y(n,"--size",t[1])},i:t,o:t,d(t){t&&a(n),e[4](null)}}}function tt(t,e,n){let r,{cellCode:o}=e,{size:i}=e;return t.$set=t=>{"cellCode"in t&&n(0,o=t.cellCode),"size"in t&&n(1,i=t.size)},[o,i,r,["none","path","start","finish"],function(t){A[t?"unshift":"push"](()=>{n(2,r=t)})}]}class et extends F{constructor(t){super(),D(this,t,tt,Z,i,{cellCode:0,size:1})}}function nt(t,e,n){return!(e<0||n<0)&&(!(e>=t[0].length||n>=t.length)&&0!==t[n][e])}function rt(t,e,n){return 3===t[n][e]}function ot(t,e,n){const r=t.slice();return r[18]=e[n],r[20]=n,r}function it(t,e,n){const r=t.slice();return r[15]=e[n],r[17]=n,r}function lt(t){let e;const n=new et({props:{cellCode:t[18],size:t[7]}});return{c(){B(n.$$.fragment)},m(t,r){O(n,t,r),e=!0},p(t,e){const r={};1&e&&(r.cellCode=t[18]),128&e&&(r.size=t[7]),n.$set(r)},i(t){e||(I(n.$$.fragment,t),e=!0)},o(t){P(n.$$.fragment,t),e=!1},d(t){R(n,t)}}}function st(t){let e,n,r=t[15],o=[];for(let e=0;e<r.length;e+=1)o[e]=lt(ot(t,r,e));const i=t=>P(o[t],1,1,()=>{o[t]=null});return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=h("")},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);f(t,e,r),n=!0},p(t,n){if(129&n){let l;for(r=t[15],l=0;l<r.length;l+=1){const i=ot(t,r,l);o[l]?(o[l].p(i,n),I(o[l],1)):(o[l]=lt(i),o[l].c(),I(o[l],1),o[l].m(e.parentNode,e))}for(j(),l=r.length;l<o.length;l+=1)i(l);S()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)I(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)P(o[t]);n=!1},d(t){d(o,t),t&&a(e)}}}function ct(t){let e,n,r,o,i,l,s=t[0],c=[];for(let e=0;e<s.length;e+=1)c[e]=st(it(t,s,e));const h=t=>P(c[t],1,1,()=>{c[t]=null});return{c(){e=p("div"),n=p("div");for(let t=0;t<c.length;t+=1)c[t].c();r=$(),o=p("div"),m(o,"class","chip svelte-1b43m4w"),y(o,"--pos-x",t[5]),y(o,"--pos-y",t[6]),m(n,"class","field svelte-1b43m4w"),C(()=>t[14].call(n)),m(e,"class","wrapper svelte-1b43m4w"),y(e,"--rows",t[1]),y(e,"--columns",t[2]),y(e,"--size",t[7])},m(s,a){f(s,e,a),u(e,n);for(let t=0;t<c.length;t+=1)c[t].m(n,null);u(n,r),u(n,o),i=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=document.createElement("object");let r;return n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.type="text/html",n.tabIndex=-1,n.onload=()=>{r=n.contentDocument.defaultView,r.addEventListener("resize",e)},/Trident/.test(navigator.userAgent)?(t.appendChild(n),n.data="about:blank"):(n.data="about:blank",t.appendChild(n)),{cancel:()=>{r&&r.removeEventListener&&r.removeEventListener("resize",e),t.removeChild(n)}}}(n,t[14].bind(n)),l=!0},p(t,[i]){if(129&i){let e;for(s=t[0],e=0;e<s.length;e+=1){const o=it(t,s,e);c[e]?(c[e].p(o,i),I(c[e],1)):(c[e]=st(o),c[e].c(),I(c[e],1),c[e].m(n,r))}for(j(),e=s.length;e<c.length;e+=1)h(e);S()}(!l||32&i)&&y(o,"--pos-x",t[5]),(!l||64&i)&&y(o,"--pos-y",t[6]),(!l||2&i)&&y(e,"--rows",t[1]),(!l||4&i)&&y(e,"--columns",t[2]),(!l||128&i)&&y(e,"--size",t[7])},i(t){if(!l){for(let t=0;t<s.length;t+=1)I(c[t]);l=!0}},o(t){c=c.filter(Boolean);for(let t=0;t<c.length;t+=1)P(c[t]);l=!1},d(t){t&&a(e),d(c,t),i.cancel()}}}function ut(t,e,n){let r,o;l(t,Q,t=>n(10,r=t)),l(t,J,t=>n(11,o=t));let i,s,c,u,f,a=[[2,1],[1,3]],d=a.length,p=a[0].length,h=0,$=0;async function g(t){n(0,a=(await import(`../levels/level${t}.js`)).default),n(1,d=a.length),n(2,p=a[0].length),n(8,h=a.findIndex(t=>t.includes(2))),n(9,$=a[h].findIndex(t=>2===t))}function m(t){return new Promise((e,r)=>{setTimeout(()=>{let r,o;switch(t){case"left":r=$-1,nt(a,r,h)?(n(9,$-=1),rt(a,$,h)&&K.set(!0)):alert("Вы вышли за пределы поля!");break;case"right":r=$+1,nt(a,r,h)?(n(9,$+=1),rt(a,$,h)&&K.set(!0)):alert("Вы вышли за пределы поля!");break;case"up":o=h-1,nt(a,$,o)?(n(8,h-=1),rt(a,$,h)&&K.set(!0)):alert("Вы вышли за пределы поля!");break;case"down":o=h+1,nt(a,$,o)?(n(8,h+=1),rt(a,$,h)&&K.set(!0)):alert("Вы вышли за пределы поля!")}e()},500)})}return x(()=>g(r)),t.$$.update=()=>{512&t.$$.dirty&&n(5,c=$+1),256&t.$$.dirty&&n(6,u=h+1),30&t.$$.dirty&&n(7,f=Math.min(i/p,s/d)-4+"px"),1024&t.$$.dirty&&g(r).catch(t=>{Q.set(1),g(r)}),2048&t.$$.dirty&&o.length>0&&o.reduce((t,e)=>t.then(()=>m(e)),Promise.resolve())},[a,d,p,i,s,c,u,f,h,$,r,o,g,m,function(){i=this.clientWidth,s=this.clientHeight,n(3,i),n(4,s)}]}class ft extends F{constructor(t){super(),D(this,t,ut,ct,i,{})}}function at(e){let n,r;return{c(){n=p("button"),n.innerHTML='<img src="img/icons/play_arrow-24px.svg" alt="START">',m(n,"title","START"),m(n,"class","svelte-1oydbdt")},m(t,e){f(t,n,e),r=g(n,"click",dt)},p:t,i:t,o:t,d(t){t&&a(n),r()}}}function dt(){G.set(!0)}class pt extends F{constructor(t){super(),D(this,t,null,at,i,{})}}function ht(t){let e,n,r;const o=t[1].default,i=function(t,e,n,r){if(t){const o=s(t,e,n,r);return t[0](o)}}(o,t,t[0],null);return{c(){e=p("div"),n=p("div"),i&&i.c(),m(n,"class","window svelte-1nhe7s8"),m(e,"class","overlay svelte-1nhe7s8")},m(t,o){f(t,e,o),u(e,n),i&&i.m(n,null),r=!0},p(t,[e]){i&&i.p&&1&e&&i.p(s(o,t,t[0],null),function(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if("object"==typeof e.dirty){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(o,t[0],e,null))},i(t){r||(I(i,t),r=!0)},o(t){P(i,t),r=!1},d(t){t&&a(e),i&&i.d(t)}}}function $t(t,e,n){let{$$slots:r={},$$scope:o}=e;return t.$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,r]}class gt extends F{constructor(t){super(),D(this,t,$t,ht,i,{})}}function mt(e){let n,o,i,l,s,c;return{c(){n=p("h1"),n.textContent="Победа!",o=$(),i=p("button"),i.innerHTML='<img src="img/icons/refresh-24px.svg" alt="">',l=$(),s=p("button"),s.innerHTML='<img src="img/icons/redo-24px.svg" alt="">',m(i,"title","Retry"),m(s,"title","Next")},m(t,r){f(t,n,r),f(t,o,r),f(t,i,r),f(t,l,r),f(t,s,r),c=[g(i,"click",e[0]),g(s,"click",e[0])]},p:t,d(t){t&&a(n),t&&a(o),t&&a(i),t&&a(l),t&&a(s),r(c)}}}function yt(t){let e,n,r,o,i;const l=new Y({}),s=new ft({}),c=new pt({}),d=new gt({props:{$$slots:{default:[mt]},$$scope:{ctx:t}}});return{c(){e=p("main"),B(l.$$.fragment),n=$(),B(s.$$.fragment),r=$(),B(c.$$.fragment),o=$(),B(d.$$.fragment),m(e,"class","svelte-1r6xykg")},m(t,a){f(t,e,a),O(l,e,null),u(e,n),O(s,e,null),u(e,r),O(c,e,null),u(e,o),O(d,e,null),i=!0},p(t,[e]){const n={};4&e&&(n.$$scope={dirty:e,ctx:t}),d.$set(n)},i(t){i||(I(l.$$.fragment,t),I(s.$$.fragment,t),I(c.$$.fragment,t),I(d.$$.fragment,t),i=!0)},o(t){P(l.$$.fragment,t),P(s.$$.fragment,t),P(c.$$.fragment,t),P(d.$$.fragment,t),i=!1},d(t){t&&a(e),R(l),R(s),R(c),R(d)}}}function bt(t,e,n){let r;return l(t,Q,t=>n(1,r=t)),t.$$.update=()=>{2&t.$$.dirty&&(document.title=`Уровень ${r}`)},[function(){Q.set(r+1),K.set(!1)}]}return new class extends F{constructor(t){super(),D(this,t,bt,yt,i,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
