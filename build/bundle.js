var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function o(t){t.forEach(e)}function r(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function i(e,n,o){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const o=e.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}function c(t,e,n,o){return t[1]&&o?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](o(e))):n.ctx}function s(t){return null==t?"":t}function u(t,e){t.appendChild(e)}function f(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function $(){return h(" ")}function g(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e,n,o){t.style.setProperty(e,n,o?"important":"")}let b;function v(t){b=t}function x(t){(function(){if(!b)throw new Error("Function called outside component initialization");return b})().$$.on_mount.push(t)}const w=[],z=[],C=[],_=[],A=Promise.resolve();let k=!1;function E(t){C.push(t)}const L=new Set;function M(){do{for(;w.length;){const t=w.shift();v(t),T(t.$$)}for(;z.length;)z.pop()();for(let t=0;t<C.length;t+=1){const e=C[t];L.has(e)||(L.add(e),e())}C.length=0}while(w.length);for(;_.length;)_.pop()();k=!1,L.clear()}function T(t){if(null!==t.fragment){t.update(),o(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(E)}}const N=new Set;let j;function H(){j={r:0,c:[],p:j}}function I(){j.r||o(j.c),j=j.p}function P(t,e){t&&t.i&&(N.delete(t),t.i(e))}function S(t,e,n,o){if(t&&t.o){if(N.has(t))return;N.add(t),j.c.push(()=>{N.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}}function B(t){t&&t.c()}function O(t,n,l){const{fragment:i,on_mount:c,on_destroy:s,after_update:u}=t.$$;i&&i.m(n,l),E(()=>{const n=c.map(e).filter(r);s?s.push(...n):o(n),t.$$.on_mount=[]}),u.forEach(E)}function q(t,e){const n=t.$$;null!==n.fragment&&(o(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function D(t,e){-1===t.$$.dirty[0]&&(w.push(t),k||(k=!0,A.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(e,r,l,i,c,s,u=[-1]){const f=b;v(e);const a=r.props||{},d=e.$$={fragment:null,ctx:null,props:s,update:t,not_equal:c,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:n(),dirty:u};let p=!1;d.ctx=l?l(e,a,(t,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&c(d.ctx[t],d.ctx[t]=r)&&(d.bound[t]&&d.bound[t](r),p&&D(e,t)),n}):[],d.update(),p=!0,o(d.before_update),d.fragment=!!i&&i(d.ctx),r.target&&(r.hydrate?d.fragment&&d.fragment.l(function(t){return Array.from(t.childNodes)}(r.target)):d.fragment&&d.fragment.c(),r.intro&&P(e.$$.fragment),O(e,r.target,r.anchor),M()),v(f)}class V{$destroy(){q(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const W=[];function G(e,n=t){let o;const r=[];function i(t){if(l(e,t)&&(e=t,o)){const t=!W.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),W.push(n,e)}if(t){for(let t=0;t<W.length;t+=2)W[t][0](W[t+1]);W.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(l,c=t){const s=[l,c];return r.push(s),1===r.length&&(o=n(i)||t),l(e),()=>{const t=r.indexOf(s);-1!==t&&r.splice(t,1),0===r.length&&(o(),o=null)}}}}const J=G(!1),K=G([]),Q=G(!1),R=G(1);String.prototype.replaceAll=function(t,e){return this.split(t).join(e)};function U(e){let n,o;return{c(){n=p("div"),m(n,"contenteditable","true"),m(n,"class","wrapper svelte-1axfo0i"),m(n,"autofocus",""),void 0===e[1]&&E(()=>e[4].call(n))},m(t,r){f(t,n,r),e[3](n),void 0!==e[1]&&(n.innerHTML=e[1]),n.focus(),o=g(n,"input",e[4])},p(t,[e]){2&e&&t[1]!==n.innerHTML&&(n.innerHTML=t[1])},i:t,o:t,d(t){t&&a(n),e[3](null),o()}}}function X(t,e,n){let o,r,l;return i(t,J,t=>n(2,o=t)),t.$$.update=()=>{if(5&t.$$.dirty&&o){const t=r.innerHTML.replaceAll(/&nbsp;/gi,"").replaceAll("</div><div>",";").replaceAll("<div>",";").replaceAll("</div>","").replaceAll("<br>","delimeter").trim().split(";").map(t=>t.trim()).filter(t=>""!==t),e=t.reduce((t,e)=>{if("delimeter"===e)return t.push(e),t;const n=e.split(" ").filter(t=>""!==t),o=n[0].toLowerCase(),r=parseInt(n[1],10);return isNaN(r)?t:(["влево","left"].includes(o)?t.push(["left",r]):["вправо","right"].includes(o)?t.push(["right",r]):["вверх","up"].includes(o)?t.push(["up",r]):["вниз","down"].includes(o)?t.push(["down",r]):["повтор","повторить","repeat"].includes(o)&&t.push(["repeat",r]),t)},[]);console.log(e);const n=function(t){const e=t.length,n=[];let o=0;for(;o<e&&o<1e3;){const e=t[o];if(Array.isArray(e)){const r=e[0],l=e[1];if("repeat"===r){t[o+1]}for(let t=0;t<l;t++)n.push(r)}o++}return n}(e);console.log(n),K.set(n)}},[r,l,o,function(t){z[t?"unshift":"push"](()=>{n(0,r=t)})},function(){l=this.innerHTML,n(1,l)}]}class Y extends V{constructor(t){super(),F(this,t,X,U,l,{})}}function Z(e){let n,o;return{c(){n=p("div"),m(n,"class",o=s(e[3][e[0]])+" svelte-dkh07z"),y(n,"--size",e[1])},m(t,o){f(t,n,o),e[4](n)},p(t,[e]){1&e&&o!==(o=s(t[3][t[0]])+" svelte-dkh07z")&&m(n,"class",o),2&e&&y(n,"--size",t[1])},i:t,o:t,d(t){t&&a(n),e[4](null)}}}function tt(t,e,n){let o,{cellCode:r}=e,{size:l}=e;return t.$set=t=>{"cellCode"in t&&n(0,r=t.cellCode),"size"in t&&n(1,l=t.size)},[r,l,o,["none","path","start","finish"],function(t){z[t?"unshift":"push"](()=>{n(2,o=t)})}]}class et extends V{constructor(t){super(),F(this,t,tt,Z,l,{cellCode:0,size:1})}}function nt(t,e,n){return!(e<0||n<0)&&(!(e>=t[0].length||n>=t.length)&&0!==t[n][e])}function ot(t,e,n){return 3===t[n][e]}function rt(t,e,n){const o=t.slice();return o[18]=e[n],o[20]=n,o}function lt(t,e,n){const o=t.slice();return o[15]=e[n],o[17]=n,o}function it(t){let e;const n=new et({props:{cellCode:t[18],size:t[7]}});return{c(){B(n.$$.fragment)},m(t,o){O(n,t,o),e=!0},p(t,e){const o={};1&e&&(o.cellCode=t[18]),128&e&&(o.size=t[7]),n.$set(o)},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){S(n.$$.fragment,t),e=!1},d(t){q(n,t)}}}function ct(t){let e,n,o=t[15],r=[];for(let e=0;e<o.length;e+=1)r[e]=it(rt(t,o,e));const l=t=>S(r[t],1,1,()=>{r[t]=null});return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=h("")},m(t,o){for(let e=0;e<r.length;e+=1)r[e].m(t,o);f(t,e,o),n=!0},p(t,n){if(129&n){let i;for(o=t[15],i=0;i<o.length;i+=1){const l=rt(t,o,i);r[i]?(r[i].p(l,n),P(r[i],1)):(r[i]=it(l),r[i].c(),P(r[i],1),r[i].m(e.parentNode,e))}for(H(),i=o.length;i<r.length;i+=1)l(i);I()}},i(t){if(!n){for(let t=0;t<o.length;t+=1)P(r[t]);n=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)S(r[t]);n=!1},d(t){d(r,t),t&&a(e)}}}function st(t){let e,n,o,r,l,i,c=t[0],s=[];for(let e=0;e<c.length;e+=1)s[e]=ct(lt(t,c,e));const h=t=>S(s[t],1,1,()=>{s[t]=null});return{c(){e=p("div"),n=p("div");for(let t=0;t<s.length;t+=1)s[t].c();o=$(),r=p("div"),m(r,"class","chip svelte-1b43m4w"),y(r,"--pos-x",t[5]),y(r,"--pos-y",t[6]),m(n,"class","field svelte-1b43m4w"),E(()=>t[14].call(n)),m(e,"class","wrapper svelte-1b43m4w"),y(e,"--rows",t[1]),y(e,"--columns",t[2]),y(e,"--size",t[7])},m(c,a){f(c,e,a),u(e,n);for(let t=0;t<s.length;t+=1)s[t].m(n,null);u(n,o),u(n,r),l=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=document.createElement("object");let o;return n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.type="text/html",n.tabIndex=-1,n.onload=()=>{o=n.contentDocument.defaultView,o.addEventListener("resize",e)},/Trident/.test(navigator.userAgent)?(t.appendChild(n),n.data="about:blank"):(n.data="about:blank",t.appendChild(n)),{cancel:()=>{o&&o.removeEventListener&&o.removeEventListener("resize",e),t.removeChild(n)}}}(n,t[14].bind(n)),i=!0},p(t,[l]){if(129&l){let e;for(c=t[0],e=0;e<c.length;e+=1){const r=lt(t,c,e);s[e]?(s[e].p(r,l),P(s[e],1)):(s[e]=ct(r),s[e].c(),P(s[e],1),s[e].m(n,o))}for(H(),e=c.length;e<s.length;e+=1)h(e);I()}(!i||32&l)&&y(r,"--pos-x",t[5]),(!i||64&l)&&y(r,"--pos-y",t[6]),(!i||2&l)&&y(e,"--rows",t[1]),(!i||4&l)&&y(e,"--columns",t[2]),(!i||128&l)&&y(e,"--size",t[7])},i(t){if(!i){for(let t=0;t<c.length;t+=1)P(s[t]);i=!0}},o(t){s=s.filter(Boolean);for(let t=0;t<s.length;t+=1)S(s[t]);i=!1},d(t){t&&a(e),d(s,t),l.cancel()}}}function ut(t,e,n){let o,r;i(t,R,t=>n(10,o=t)),i(t,K,t=>n(11,r=t));let l,c,s,u,f,a=[[2,1],[1,3]],d=a.length,p=a[0].length,h=0,$=0;async function g(t){n(0,a=(await import(`../levels/level${t}.js`)).default),n(1,d=a.length),n(2,p=a[0].length),n(8,h=a.findIndex(t=>t.includes(2))),n(9,$=a[h].findIndex(t=>2===t))}function m(t){return new Promise((e,o)=>{setTimeout(()=>{let o,r;switch(t){case"left":o=$-1,nt(a,o,h)?(n(9,$-=1),ot(a,$,h)&&Q.set(!0)):alert("Вы вышли за пределы поля!");break;case"right":o=$+1,nt(a,o,h)?(n(9,$+=1),ot(a,$,h)&&Q.set(!0)):alert("Вы вышли за пределы поля!");break;case"up":r=h-1,nt(a,$,r)?(n(8,h-=1),ot(a,$,h)&&Q.set(!0)):alert("Вы вышли за пределы поля!");break;case"down":r=h+1,nt(a,$,r)?(n(8,h+=1),ot(a,$,h)&&Q.set(!0)):alert("Вы вышли за пределы поля!")}e()},500)})}return x(()=>g(o)),t.$$.update=()=>{512&t.$$.dirty&&n(5,s=$+1),256&t.$$.dirty&&n(6,u=h+1),30&t.$$.dirty&&n(7,f=Math.min(l/p,c/d)-4+"px"),1024&t.$$.dirty&&g(o),2048&t.$$.dirty&&r.length>0&&r.reduce((t,e)=>t.then(()=>m(e)),Promise.resolve())},[a,d,p,l,c,s,u,f,h,$,o,r,g,m,function(){l=this.clientWidth,c=this.clientHeight,n(3,l),n(4,c)}]}class ft extends V{constructor(t){super(),F(this,t,ut,st,l,{})}}function at(e){let n,o;return{c(){n=p("button"),n.textContent="СТАРТ",m(n,"class","svelte-1oydbdt")},m(t,e){f(t,n,e),o=g(n,"click",dt)},p:t,i:t,o:t,d(t){t&&a(n),o()}}}function dt(){J.set(!0)}class pt extends V{constructor(t){super(),F(this,t,null,at,l,{})}}function ht(t){let e,n,o;const r=t[1].default,l=function(t,e,n,o){if(t){const r=c(t,e,n,o);return t[0](r)}}(r,t,t[0],null);return{c(){e=p("div"),n=p("div"),l&&l.c(),m(n,"class","window svelte-gorigs"),m(e,"class","overlay svelte-gorigs")},m(t,r){f(t,e,r),u(e,n),l&&l.m(n,null),o=!0},p(t,[e]){l&&l.p&&1&e&&l.p(c(r,t,t[0],null),function(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if("object"==typeof e.dirty){const t=[],n=Math.max(e.dirty.length,r.length);for(let o=0;o<n;o+=1)t[o]=e.dirty[o]|r[o];return t}return e.dirty|r}return e.dirty}(r,t[0],e,null))},i(t){o||(P(l,t),o=!0)},o(t){S(l,t),o=!1},d(t){t&&a(e),l&&l.d(t)}}}function $t(t,e,n){let{$$slots:o={},$$scope:r}=e;return t.$set=t=>{"$$scope"in t&&n(0,r=t.$$scope)},[r,o]}class gt extends V{constructor(t){super(),F(this,t,$t,ht,l,{})}}function mt(t){let e;const n=new gt({props:{$$slots:{default:[yt]},$$scope:{ctx:t}}});return{c(){B(n.$$.fragment)},m(t,o){O(n,t,o),e=!0},p(t,e){const o={};8&e&&(o.$$scope={dirty:e,ctx:t}),n.$set(o)},i(t){e||(P(n.$$.fragment,t),e=!0)},o(t){S(n.$$.fragment,t),e=!1},d(t){q(n,t)}}}function yt(e){let n,o,r,l;return{c(){n=p("span"),n.textContent="Победа!",o=$(),r=p("button"),r.textContent="Next"},m(t,i){f(t,n,i),f(t,o,i),f(t,r,i),l=g(r,"click",e[1])},p:t,d(t){t&&a(n),t&&a(o),t&&a(r),l()}}}function bt(t){let e,n,o,r,l;const i=new Y({}),c=new ft({}),s=new pt({});let d=t[0]&&mt(t);return{c(){e=p("main"),B(i.$$.fragment),n=$(),B(c.$$.fragment),o=$(),B(s.$$.fragment),r=$(),d&&d.c(),m(e,"class","svelte-1r6xykg")},m(t,a){f(t,e,a),O(i,e,null),u(e,n),O(c,e,null),u(e,o),O(s,e,null),u(e,r),d&&d.m(e,null),l=!0},p(t,[n]){t[0]?d?(d.p(t,n),P(d,1)):(d=mt(t),d.c(),P(d,1),d.m(e,null)):d&&(H(),S(d,1,1,()=>{d=null}),I())},i(t){l||(P(i.$$.fragment,t),P(c.$$.fragment,t),P(s.$$.fragment,t),P(d),l=!0)},o(t){S(i.$$.fragment,t),S(c.$$.fragment,t),S(s.$$.fragment,t),S(d),l=!1},d(t){t&&a(e),q(i),q(c),q(s),d&&d.d()}}}function vt(t,e,n){let o,r;return i(t,R,t=>n(2,o=t)),i(t,Q,t=>n(0,r=t)),console.log(document.title),t.$$.update=()=>{4&t.$$.dirty&&(document.title=`${document.title} Уровень ${o}`)},[r,function(){R.set(o+1),Q.set(!1)}]}return new class extends V{constructor(t){super(),F(this,t,vt,bt,l,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
