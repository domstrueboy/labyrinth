var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function l(t){return"function"==typeof t}function s(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function i(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function c(t){return null==t?"":t}function u(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function $(t){return document.createTextNode(t)}function h(){return $(" ")}function g(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function v(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}let y;function b(t){y=t}function x(t){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.on_mount.push(t)}const w=[],H=[],_=[],k=[],z=Promise.resolve();let C=!1;function A(t){_.push(t)}const E=new Set;function L(){do{for(;w.length;){const t=w.shift();b(t),q(t.$$)}for(;H.length;)H.pop()();for(let t=0;t<_.length;t+=1){const e=_[t];E.has(e)||(E.add(e),e())}_.length=0}while(w.length);for(;k.length;)k.pop()();C=!1,E.clear()}function q(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const I=new Set;let M;function T(){M={r:0,c:[],p:M}}function j(){M.r||r(M.c),M=M.p}function N(t,e){t&&t.i&&(I.delete(t),t.i(e))}function S(t,e,n,r){if(t&&t.o){if(I.has(t))return;I.add(t),M.c.push(()=>{I.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function P(t){t&&t.c()}function B(t,n,s){const{fragment:o,on_mount:i,on_destroy:c,after_update:u}=t.$$;o&&o.m(n,s),A(()=>{const n=i.map(e).filter(l);c?c.push(...n):r(n),t.$$.on_mount=[]}),u.forEach(A)}function O(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function D(t,e){-1===t.$$.dirty[0]&&(w.push(t),C||(C=!0,z.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(e,l,s,o,i,c,u=[-1]){const a=y;b(e);const f=l.props||{},d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:n(),dirty:u};let p=!1;d.ctx=s?s(e,f,(t,n,...r)=>{const l=r.length?r[0]:n;return d.ctx&&i(d.ctx[t],d.ctx[t]=l)&&(d.bound[t]&&d.bound[t](l),p&&D(e,t)),n}):[],d.update(),p=!0,r(d.before_update),d.fragment=!!o&&o(d.ctx),l.target&&(l.hydrate?d.fragment&&d.fragment.l(function(t){return Array.from(t.childNodes)}(l.target)):d.fragment&&d.fragment.c(),l.intro&&N(e.$$.fragment),B(e,l.target,l.anchor),L()),b(a)}class V{$destroy(){O(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const W=[];function G(e,n=t){let r;const l=[];function o(t){if(s(e,t)&&(e=t,r)){const t=!W.length;for(let t=0;t<l.length;t+=1){const n=l[t];n[1](),W.push(n,e)}if(t){for(let t=0;t<W.length;t+=2)W[t][0](W[t+1]);W.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,i=t){const c=[s,i];return l.push(c),1===l.length&&(r=n(o)||t),s(e),()=>{const t=l.indexOf(c);-1!==t&&l.splice(t,1),0===l.length&&(r(),r=null)}}}}const J=G(""),K=G([]),Q=G(parseInt(localStorage.getItem("level"),10)||1);Q.subscribe(t=>{localStorage.setItem("level",t)});const R=G(null);String.prototype.replaceAll=function(t,e){return this.split(t).join(e)};let U=[];function X(e){let n,r;return{c(){n=p("div"),m(n,"contenteditable","true"),m(n,"class","wrapper svelte-1axfo0i"),m(n,"autofocus",""),void 0===e[1]&&A(()=>e[4].call(n))},m(t,l){a(t,n,l),e[3](n),void 0!==e[1]&&(n.innerHTML=e[1]),n.focus(),r=g(n,"input",e[4])},p(t,[e]){2&e&&t[1]!==n.innerHTML&&(n.innerHTML=t[1])},i:t,o:t,d(t){t&&f(n),e[3](null),r()}}}function Y(t,e,n){let r,l,s;return o(t,R,t=>n(2,r=t)),o(t,J,t=>n(1,l=t)),t.$$.update=()=>{if(6&t.$$.dirty&&"started"===r){const t=l.replaceAll(/&nbsp;/gi,"").replaceAll("</div><div>",";").replaceAll("<div>",";").replaceAll("</div>","").replaceAll("<br>","delimeter").trim().split(";").map(t=>t.trim()).filter(t=>""!==t),e=function t(e,n){"start"===n&&(U=[]);const r=e.length;let l=0;for(;l<r&&l<1e3;){const n=e[l],s=n[0],o=n[1];if("repeat"===s){const n=[];let s=l+1;for(;"delimeter"!==e[s]&&s<r&&s<1e3;)n.push(e[s]),s++;l=s;for(let e=0;e<o;e++)t(n)}else for(let t=0;t<o;t++)U.push(s);l++}return U}(t.reduce((t,e)=>{if("delimeter"===e)return t.push(e),t;const n=e.split(" ").filter(t=>""!==t),r=n[0].toLowerCase(),l=parseInt(n[1],10);return isNaN(l)?t:(["влево","left"].includes(r)?t.push(["left",l]):["вправо","right"].includes(r)?t.push(["right",l]):["вверх","up"].includes(r)?t.push(["up",l]):["вниз","down"].includes(r)?t.push(["down",l]):["повтор","повторить","repeat"].includes(r)&&t.push(["repeat",l]),t)},[]),"start");K.set(e)}},[s,l,r,function(t){H[t?"unshift":"push"](()=>{n(0,s=t)})},function(){l=this.innerHTML,J.set(l)}]}class Z extends V{constructor(t){super(),F(this,t,Y,X,s,{})}}function tt(e){let n,r;return{c(){n=p("div"),m(n,"class",r=c(e[3][e[0]])+" svelte-dkh07z"),v(n,"--size",e[1])},m(t,r){a(t,n,r),e[4](n)},p(t,[e]){1&e&&r!==(r=c(t[3][t[0]])+" svelte-dkh07z")&&m(n,"class",r),2&e&&v(n,"--size",t[1])},i:t,o:t,d(t){t&&f(n),e[4](null)}}}function et(t,e,n){let r,{cellCode:l}=e,{size:s}=e;return t.$set=t=>{"cellCode"in t&&n(0,l=t.cellCode),"size"in t&&n(1,s=t.size)},[l,s,r,["none","path","start","finish"],function(t){H[t?"unshift":"push"](()=>{n(2,r=t)})}]}class nt extends V{constructor(t){super(),F(this,t,et,tt,s,{cellCode:0,size:1})}}function rt(t,e,n){const r=t.slice();return r[19]=e[n],r[21]=n,r}function lt(t,e,n){const r=t.slice();return r[16]=e[n],r[18]=n,r}function st(t){let e;const n=new nt({props:{cellCode:t[19],size:t[7]}});return{c(){P(n.$$.fragment)},m(t,r){B(n,t,r),e=!0},p(t,e){const r={};1&e&&(r.cellCode=t[19]),128&e&&(r.size=t[7]),n.$set(r)},i(t){e||(N(n.$$.fragment,t),e=!0)},o(t){S(n.$$.fragment,t),e=!1},d(t){O(n,t)}}}function ot(t){let e,n,r=t[16],l=[];for(let e=0;e<r.length;e+=1)l[e]=st(rt(t,r,e));const s=t=>S(l[t],1,1,()=>{l[t]=null});return{c(){for(let t=0;t<l.length;t+=1)l[t].c();e=$("")},m(t,r){for(let e=0;e<l.length;e+=1)l[e].m(t,r);a(t,e,r),n=!0},p(t,n){if(129&n){let o;for(r=t[16],o=0;o<r.length;o+=1){const s=rt(t,r,o);l[o]?(l[o].p(s,n),N(l[o],1)):(l[o]=st(s),l[o].c(),N(l[o],1),l[o].m(e.parentNode,e))}for(T(),o=r.length;o<l.length;o+=1)s(o);j()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)N(l[t]);n=!0}},o(t){l=l.filter(Boolean);for(let t=0;t<l.length;t+=1)S(l[t]);n=!1},d(t){d(l,t),t&&f(e)}}}function it(t){let e,n,r,l,s,o,i,c,$=t[0],g=[];for(let e=0;e<$.length;e+=1)g[e]=ot(lt(t,$,e));const y=t=>S(g[t],1,1,()=>{g[t]=null});return{c(){e=p("div"),n=p("div");for(let t=0;t<g.length;t+=1)g[t].c();r=h(),l=p("div"),s=p("img"),m(s,"class","chip__img svelte-1kqaua6"),s.src!==(o="img/bug.svg")&&m(s,"src","img/bug.svg"),m(s,"alt",""),m(l,"class","chip svelte-1kqaua6"),v(l,"--pos-x",t[5]),v(l,"--pos-y",t[6]),m(n,"class","field svelte-1kqaua6"),A(()=>t[15].call(n)),m(e,"class","wrapper svelte-1kqaua6"),v(e,"--rows",t[1]),v(e,"--columns",t[2]),v(e,"--size",t[7])},m(o,f){a(o,e,f),u(e,n);for(let t=0;t<g.length;t+=1)g[t].m(n,null);u(n,r),u(n,l),u(l,s),i=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=document.createElement("object");let r;return n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.type="text/html",n.tabIndex=-1,n.onload=()=>{r=n.contentDocument.defaultView,r.addEventListener("resize",e)},/Trident/.test(navigator.userAgent)?(t.appendChild(n),n.data="about:blank"):(n.data="about:blank",t.appendChild(n)),{cancel:()=>{r&&r.removeEventListener&&r.removeEventListener("resize",e),t.removeChild(n)}}}(n,t[15].bind(n)),c=!0},p(t,[s]){if(129&s){let e;for($=t[0],e=0;e<$.length;e+=1){const l=lt(t,$,e);g[e]?(g[e].p(l,s),N(g[e],1)):(g[e]=ot(l),g[e].c(),N(g[e],1),g[e].m(n,r))}for(T(),e=$.length;e<g.length;e+=1)y(e);j()}(!c||32&s)&&v(l,"--pos-x",t[5]),(!c||64&s)&&v(l,"--pos-y",t[6]),(!c||2&s)&&v(e,"--rows",t[1]),(!c||4&s)&&v(e,"--columns",t[2]),(!c||128&s)&&v(e,"--size",t[7])},i(t){if(!c){for(let t=0;t<$.length;t+=1)N(g[t]);c=!0}},o(t){g=g.filter(Boolean);for(let t=0;t<g.length;t+=1)S(g[t]);c=!1},d(t){t&&f(e),d(g,t),i.cancel()}}}function ct(t,e,n){let r,l,s;o(t,Q,t=>n(10,r=t)),o(t,R,t=>n(11,l=t)),o(t,K,t=>n(12,s=t));let i,c,u,a,f,d=[[2,1],[1,3]],p=d.length,$=d[0].length,h=0,g=0;async function m(t){n(0,d=(await import(`../levels/level${t}.js`)).default),J.set(""),K.set([]),R.set(null),n(1,p=d.length),n(2,$=d[0].length),n(8,h=d.findIndex(t=>t.includes(2))),n(9,g=d[h].findIndex(t=>2===t))}function v(t,e){return new Promise(r=>{if("win"!==l&&"lose"!==l){switch(t){case"left":n(9,g--,g);break;case"right":n(9,g++,g);break;case"up":n(8,h--,h);break;case"down":n(8,h++,h)}setTimeout(()=>{!function(t,e,n){return!(e<0||n<0)&&(!(e>=t[0].length||n>=t.length)&&0!==t[n][e])}(d,g,h)?R.set("lose"):!function(t,e,n){return 3===t[n][e]}(d,g,h)?e&&R.set("lose"):R.set("win"),r()},500)}else r()})}return x(()=>m(r)),t.$$.update=()=>{512&t.$$.dirty&&n(5,u=g+1),256&t.$$.dirty&&n(6,a=h+1),30&t.$$.dirty&&n(7,f=Math.min(i/$,c/p)-4+"px"),3072&t.$$.dirty&&null===l&&m(r).catch(t=>{Q.set(1),m(r)}),4096&t.$$.dirty&&(s.length>0?s.reduce((t,e,n)=>t.then(()=>v(e,n===s.length-1)),Promise.resolve()):R.set(null))},[d,p,$,i,c,u,a,f,h,g,r,l,s,m,v,function(){i=this.clientWidth,c=this.clientHeight,n(3,i),n(4,c)}]}class ut extends V{constructor(t){super(),F(this,t,ct,it,s,{})}}function at(e){let n,r,l,s;return{c(){n=p("button"),r=p("img"),r.src!==(l=e[1])&&m(r,"src",l),m(r,"alt",""),m(r,"class","svelte-1mfm20n"),m(n,"title",e[0]),n.disabled=e[3],m(n,"class","svelte-1mfm20n")},m(t,l){a(t,n,l),u(n,r),s=g(n,"click",e[2])},p(t,[e]){2&e&&r.src!==(l=t[1])&&m(r,"src",l),1&e&&m(n,"title",t[0]),8&e&&(n.disabled=t[3])},i:t,o:t,d(t){t&&f(n),s()}}}function ft(t,e,n){let{title:r}=e,{icon:l}=e,{handler:s}=e,{disabled:o=!1}=e;return t.$set=t=>{"title"in t&&n(0,r=t.title),"icon"in t&&n(1,l=t.icon),"handler"in t&&n(2,s=t.handler),"disabled"in t&&n(3,o=t.disabled)},[r,l,s,o]}class dt extends V{constructor(t){super(),F(this,t,ft,at,s,{title:0,icon:1,handler:2,disabled:3})}}function pt(t){let e,n,r;const l=t[1].default,s=function(t,e,n,r){if(t){const l=i(t,e,n,r);return t[0](l)}}(l,t,t[0],null);return{c(){e=p("div"),n=p("div"),s&&s.c(),m(n,"class","window svelte-vsq1ag"),m(e,"class","overlay svelte-vsq1ag")},m(t,l){a(t,e,l),u(e,n),s&&s.m(n,null),r=!0},p(t,[e]){s&&s.p&&1&e&&s.p(i(l,t,t[0],null),function(t,e,n,r){if(t[2]&&r){const l=t[2](r(n));if("object"==typeof e.dirty){const t=[],n=Math.max(e.dirty.length,l.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|l[r];return t}return e.dirty|l}return e.dirty}(l,t[0],e,null))},i(t){r||(N(s,t),r=!0)},o(t){S(s,t),r=!1},d(t){t&&f(e),s&&s.d(t)}}}function $t(t,e,n){let{$$slots:r={},$$scope:l}=e;return t.$set=t=>{"$$scope"in t&&n(0,l=t.$$scope)},[l,r]}class ht extends V{constructor(t){super(),F(this,t,$t,pt,s,{})}}function gt(t){let e,n,r,l;const s=new dt({props:{title:"Заново",icon:"img/icons/refresh-24px.svg",handler:t[1]}}),o=new dt({props:{title:"Дальше",icon:"img/icons/redo-24px.svg",handler:t[0]}});return{c(){e=p("h1"),e.textContent="Победа!",n=h(),P(s.$$.fragment),r=h(),P(o.$$.fragment),m(e,"class","svelte-14xsa5s")},m(t,i){a(t,e,i),a(t,n,i),B(s,t,i),a(t,r,i),B(o,t,i),l=!0},p(t,[e]){const n={};2&e&&(n.handler=t[1]),s.$set(n);const r={};1&e&&(r.handler=t[0]),o.$set(r)},i(t){l||(N(s.$$.fragment,t),N(o.$$.fragment,t),l=!0)},o(t){S(s.$$.fragment,t),S(o.$$.fragment,t),l=!1},d(t){t&&f(e),t&&f(n),O(s,t),t&&f(r),O(o,t)}}}function mt(t,e,n){let{nextHandler:r}=e,{retryHandler:l}=e;return t.$set=t=>{"nextHandler"in t&&n(0,r=t.nextHandler),"retryHandler"in t&&n(1,l=t.retryHandler)},[r,l]}class vt extends V{constructor(t){super(),F(this,t,mt,gt,s,{nextHandler:0,retryHandler:1})}}function yt(t){let e,n,r;const l=new dt({props:{title:"Заново",icon:"img/icons/refresh-24px.svg",handler:t[0]}});return{c(){e=p("h1"),e.textContent="Ты проиграла!",n=h(),P(l.$$.fragment),m(e,"class","svelte-14xsa5s")},m(t,s){a(t,e,s),a(t,n,s),B(l,t,s),r=!0},p(t,[e]){const n={};1&e&&(n.handler=t[0]),l.$set(n)},i(t){r||(N(l.$$.fragment,t),r=!0)},o(t){S(l.$$.fragment,t),r=!1},d(t){t&&f(e),t&&f(n),O(l,t)}}}function bt(t,e,n){let{retryHandler:r}=e;return t.$set=t=>{"retryHandler"in t&&n(0,r=t.retryHandler)},[r]}class xt extends V{constructor(t){super(),F(this,t,bt,yt,s,{retryHandler:0})}}function wt(t){let e;const n=new ht({props:{$$slots:{default:[_t]},$$scope:{ctx:t}}});return{c(){P(n.$$.fragment)},m(t,r){B(n,t,r),e=!0},p(t,e){const r={};8&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){e||(N(n.$$.fragment,t),e=!0)},o(t){S(n.$$.fragment,t),e=!1},d(t){O(n,t)}}}function Ht(t){let e;const n=new ht({props:{$$slots:{default:[kt]},$$scope:{ctx:t}}});return{c(){P(n.$$.fragment)},m(t,r){B(n,t,r),e=!0},p(t,e){const r={};8&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){e||(N(n.$$.fragment,t),e=!0)},o(t){S(n.$$.fragment,t),e=!1},d(t){O(n,t)}}}function _t(e){let n;const r=new xt({props:{retryHandler:At}});return{c(){P(r.$$.fragment)},m(t,e){B(r,t,e),n=!0},p:t,i(t){n||(N(r.$$.fragment,t),n=!0)},o(t){S(r.$$.fragment,t),n=!1},d(t){O(r,t)}}}function kt(e){let n;const r=new vt({props:{nextHandler:e[1],retryHandler:At}});return{c(){P(r.$$.fragment)},m(t,e){B(r,t,e),n=!0},p:t,i(t){n||(N(r.$$.fragment,t),n=!0)},o(t){S(r.$$.fragment,t),n=!1},d(t){O(r,t)}}}function zt(t){let e,n,r,l,s,o,i,c;const d=new Z({}),$=new ut({}),g=new dt({props:{title:"Старт",icon:"img/icons/play_arrow-24px.svg",handler:Ct,disabled:"started"===t[0]}}),v=[Ht,wt],y=[];function b(t,e){return"win"===t[0]?0:"lose"===t[0]?1:-1}return~(o=b(t))&&(i=y[o]=v[o](t)),{c(){e=p("main"),P(d.$$.fragment),n=h(),P($.$$.fragment),r=h(),l=p("div"),P(g.$$.fragment),s=h(),i&&i.c(),m(l,"class","start-button svelte-qlkt7z"),m(e,"class","svelte-qlkt7z")},m(t,i){a(t,e,i),B(d,e,null),u(e,n),B($,e,null),u(e,r),u(e,l),B(g,l,null),u(e,s),~o&&y[o].m(e,null),c=!0},p(t,[n]){const r={};1&n&&(r.disabled="started"===t[0]),g.$set(r);let l=o;o=b(t),o===l?~o&&y[o].p(t,n):(i&&(T(),S(y[l],1,1,()=>{y[l]=null}),j()),~o?(i=y[o],i||(i=y[o]=v[o](t),i.c()),N(i,1),i.m(e,null)):i=null)},i(t){c||(N(d.$$.fragment,t),N($.$$.fragment,t),N(g.$$.fragment,t),N(i),c=!0)},o(t){S(d.$$.fragment,t),S($.$$.fragment,t),S(g.$$.fragment,t),S(i),c=!1},d(t){t&&f(e),O(d),O($),O(g),~o&&y[o].d()}}}function Ct(){R.set("started")}function At(){R.set(null)}function Et(t,e,n){let r,l;return o(t,Q,t=>n(2,r=t)),o(t,R,t=>n(0,l=t)),t.$$.update=()=>{4&t.$$.dirty&&(document.title=`Уровень ${r}`)},[l,function(){Q.set(r+1),R.set(null)}]}return new class extends V{constructor(t){super(),F(this,t,Et,zt,s,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
