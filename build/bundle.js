var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function l(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(e,n,r){e.$$.on_destroy.push(function(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function i(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function c(t){return null==t?"":t}function u(t,e){t.appendChild(e)}function a(t,e,n){t.insertBefore(e,n||null)}function f(t){t.parentNode.removeChild(t)}function d(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function p(t){return document.createElement(t)}function $(t){return document.createTextNode(t)}function h(){return $(" ")}function m(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function y(t,e,n,r){t.style.setProperty(e,n,r?"important":"")}let v;function b(t){v=t}function x(t){(function(){if(!v)throw new Error("Function called outside component initialization");return v})().$$.on_mount.push(t)}const w=[],H=[],z=[],_=[],C=Promise.resolve();let k=!1;function A(t){z.push(t)}const E=new Set;function L(){do{for(;w.length;){const t=w.shift();b(t),M(t.$$)}for(;H.length;)H.pop()();for(let t=0;t<z.length;t+=1){const e=z[t];E.has(e)||(E.add(e),e())}z.length=0}while(w.length);for(;_.length;)_.pop()();k=!1,E.clear()}function M(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(A)}}const T=new Set;let j;function N(){j={r:0,c:[],p:j}}function q(){j.r||r(j.c),j=j.p}function I(t,e){t&&t.i&&(T.delete(t),t.i(e))}function P(t,e,n,r){if(t&&t.o){if(T.has(t))return;T.add(t),j.c.push(()=>{T.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}}function S(t){t&&t.c()}function B(t,n,l){const{fragment:s,on_mount:i,on_destroy:c,after_update:u}=t.$$;s&&s.m(n,l),A(()=>{const n=i.map(e).filter(o);c?c.push(...n):r(n),t.$$.on_mount=[]}),u.forEach(A)}function O(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function D(t,e){-1===t.$$.dirty[0]&&(w.push(t),k||(k=!0,C.then(L)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function F(e,o,l,s,i,c,u=[-1]){const a=v;b(e);const f=o.props||{},d=e.$$={fragment:null,ctx:null,props:c,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:n(),dirty:u};let p=!1;d.ctx=l?l(e,f,(t,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&i(d.ctx[t],d.ctx[t]=o)&&(d.bound[t]&&d.bound[t](o),p&&D(e,t)),n}):[],d.update(),p=!0,r(d.before_update),d.fragment=!!s&&s(d.ctx),o.target&&(o.hydrate?d.fragment&&d.fragment.l(function(t){return Array.from(t.childNodes)}(o.target)):d.fragment&&d.fragment.c(),o.intro&&I(e.$$.fragment),B(e,o.target,o.anchor),L()),b(a)}class V{$destroy(){O(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(){}}const W=[];function G(e,n=t){let r;const o=[];function s(t){if(l(e,t)&&(e=t,r)){const t=!W.length;for(let t=0;t<o.length;t+=1){const n=o[t];n[1](),W.push(n,e)}if(t){for(let t=0;t<W.length;t+=2)W[t][0](W[t+1]);W.length=0}}}return{set:s,update:function(t){s(t(e))},subscribe:function(l,i=t){const c=[l,i];return o.push(c),1===o.length&&(r=n(s)||t),l(e),()=>{const t=o.indexOf(c);-1!==t&&o.splice(t,1),0===o.length&&(r(),r=null)}}}}const J=G(""),K=G([]),Q=G(1),R=G(null);String.prototype.replaceAll=function(t,e){return this.split(t).join(e)};let U=[];function X(e){let n,r;return{c(){n=p("div"),g(n,"contenteditable","true"),g(n,"class","wrapper svelte-1axfo0i"),g(n,"autofocus",""),void 0===e[1]&&A(()=>e[4].call(n))},m(t,o){a(t,n,o),e[3](n),void 0!==e[1]&&(n.innerHTML=e[1]),n.focus(),r=m(n,"input",e[4])},p(t,[e]){2&e&&t[1]!==n.innerHTML&&(n.innerHTML=t[1])},i:t,o:t,d(t){t&&f(n),e[3](null),r()}}}function Y(t,e,n){let r,o,l;return s(t,R,t=>n(2,r=t)),s(t,J,t=>n(1,o=t)),t.$$.update=()=>{if(6&t.$$.dirty&&"started"===r){const t=o.replaceAll(/&nbsp;/gi,"").replaceAll("</div><div>",";").replaceAll("<div>",";").replaceAll("</div>","").replaceAll("<br>","delimeter").trim().split(";").map(t=>t.trim()).filter(t=>""!==t),e=function t(e,n){"start"===n&&(U=[]);const r=e.length;let o=0;for(;o<r&&o<1e3;){const n=e[o],l=n[0],s=n[1];if("repeat"===l){const n=[];let l=o+1;for(;"delimeter"!==e[l]&&l<r&&l<1e3;)n.push(e[l]),l++;o=l;for(let e=0;e<s;e++)t(n)}else for(let t=0;t<s;t++)U.push(l);o++}return U}(t.reduce((t,e)=>{if("delimeter"===e)return t.push(e),t;const n=e.split(" ").filter(t=>""!==t),r=n[0].toLowerCase(),o=parseInt(n[1],10);return isNaN(o)?t:(["влево","left"].includes(r)?t.push(["left",o]):["вправо","right"].includes(r)?t.push(["right",o]):["вверх","up"].includes(r)?t.push(["up",o]):["вниз","down"].includes(r)?t.push(["down",o]):["повтор","повторить","repeat"].includes(r)&&t.push(["repeat",o]),t)},[]),"start");K.set(e)}},[l,o,r,function(t){H[t?"unshift":"push"](()=>{n(0,l=t)})},function(){o=this.innerHTML,J.set(o)}]}class Z extends V{constructor(t){super(),F(this,t,Y,X,l,{})}}function tt(e){let n,r;return{c(){n=p("div"),g(n,"class",r=c(e[3][e[0]])+" svelte-dkh07z"),y(n,"--size",e[1])},m(t,r){a(t,n,r),e[4](n)},p(t,[e]){1&e&&r!==(r=c(t[3][t[0]])+" svelte-dkh07z")&&g(n,"class",r),2&e&&y(n,"--size",t[1])},i:t,o:t,d(t){t&&f(n),e[4](null)}}}function et(t,e,n){let r,{cellCode:o}=e,{size:l}=e;return t.$set=t=>{"cellCode"in t&&n(0,o=t.cellCode),"size"in t&&n(1,l=t.size)},[o,l,r,["none","path","start","finish"],function(t){H[t?"unshift":"push"](()=>{n(2,r=t)})}]}class nt extends V{constructor(t){super(),F(this,t,et,tt,l,{cellCode:0,size:1})}}function rt(t,e,n){const r=t.slice();return r[19]=e[n],r[21]=n,r}function ot(t,e,n){const r=t.slice();return r[16]=e[n],r[18]=n,r}function lt(t){let e;const n=new nt({props:{cellCode:t[19],size:t[7]}});return{c(){S(n.$$.fragment)},m(t,r){B(n,t,r),e=!0},p(t,e){const r={};1&e&&(r.cellCode=t[19]),128&e&&(r.size=t[7]),n.$set(r)},i(t){e||(I(n.$$.fragment,t),e=!0)},o(t){P(n.$$.fragment,t),e=!1},d(t){O(n,t)}}}function st(t){let e,n,r=t[16],o=[];for(let e=0;e<r.length;e+=1)o[e]=lt(rt(t,r,e));const l=t=>P(o[t],1,1,()=>{o[t]=null});return{c(){for(let t=0;t<o.length;t+=1)o[t].c();e=$("")},m(t,r){for(let e=0;e<o.length;e+=1)o[e].m(t,r);a(t,e,r),n=!0},p(t,n){if(129&n){let s;for(r=t[16],s=0;s<r.length;s+=1){const l=rt(t,r,s);o[s]?(o[s].p(l,n),I(o[s],1)):(o[s]=lt(l),o[s].c(),I(o[s],1),o[s].m(e.parentNode,e))}for(N(),s=r.length;s<o.length;s+=1)l(s);q()}},i(t){if(!n){for(let t=0;t<r.length;t+=1)I(o[t]);n=!0}},o(t){o=o.filter(Boolean);for(let t=0;t<o.length;t+=1)P(o[t]);n=!1},d(t){d(o,t),t&&f(e)}}}function it(t){let e,n,r,o,l,s,i=t[0],c=[];for(let e=0;e<i.length;e+=1)c[e]=st(ot(t,i,e));const $=t=>P(c[t],1,1,()=>{c[t]=null});return{c(){e=p("div"),n=p("div");for(let t=0;t<c.length;t+=1)c[t].c();r=h(),o=p("div"),g(o,"class","chip svelte-1b43m4w"),y(o,"--pos-x",t[5]),y(o,"--pos-y",t[6]),g(n,"class","field svelte-1b43m4w"),A(()=>t[15].call(n)),g(e,"class","wrapper svelte-1b43m4w"),y(e,"--rows",t[1]),y(e,"--columns",t[2]),y(e,"--size",t[7])},m(i,f){a(i,e,f),u(e,n);for(let t=0;t<c.length;t+=1)c[t].m(n,null);u(n,r),u(n,o),l=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=document.createElement("object");let r;return n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.type="text/html",n.tabIndex=-1,n.onload=()=>{r=n.contentDocument.defaultView,r.addEventListener("resize",e)},/Trident/.test(navigator.userAgent)?(t.appendChild(n),n.data="about:blank"):(n.data="about:blank",t.appendChild(n)),{cancel:()=>{r&&r.removeEventListener&&r.removeEventListener("resize",e),t.removeChild(n)}}}(n,t[15].bind(n)),s=!0},p(t,[l]){if(129&l){let e;for(i=t[0],e=0;e<i.length;e+=1){const o=ot(t,i,e);c[e]?(c[e].p(o,l),I(c[e],1)):(c[e]=st(o),c[e].c(),I(c[e],1),c[e].m(n,r))}for(N(),e=i.length;e<c.length;e+=1)$(e);q()}(!s||32&l)&&y(o,"--pos-x",t[5]),(!s||64&l)&&y(o,"--pos-y",t[6]),(!s||2&l)&&y(e,"--rows",t[1]),(!s||4&l)&&y(e,"--columns",t[2]),(!s||128&l)&&y(e,"--size",t[7])},i(t){if(!s){for(let t=0;t<i.length;t+=1)I(c[t]);s=!0}},o(t){c=c.filter(Boolean);for(let t=0;t<c.length;t+=1)P(c[t]);s=!1},d(t){t&&f(e),d(c,t),l.cancel()}}}function ct(t,e,n){let r,o,l;s(t,Q,t=>n(10,r=t)),s(t,R,t=>n(11,o=t)),s(t,K,t=>n(12,l=t));let i,c,u,a,f,d=[[2,1],[1,3]],p=d.length,$=d[0].length,h=0,m=0;async function g(t){n(0,d=(await import(`../levels/level${t}.js`)).default),J.set(""),K.set([]),R.set(null),n(1,p=d.length),n(2,$=d[0].length),n(8,h=d.findIndex(t=>t.includes(2))),n(9,m=d[h].findIndex(t=>2===t))}function y(t,e){return new Promise(r=>{if("win"!==o&&"lose"!==o){switch(t){case"left":n(9,m--,m);break;case"right":n(9,m++,m);break;case"up":n(8,h--,h);break;case"down":n(8,h++,h)}setTimeout(()=>{!function(t,e,n){return!(e<0||n<0)&&(!(e>=t[0].length||n>=t.length)&&0!==t[n][e])}(d,m,h)?R.set("lose"):!function(t,e,n){return 3===t[n][e]}(d,m,h)?e&&R.set("lose"):R.set("win"),r()},500)}else r()})}return x(()=>g(r)),t.$$.update=()=>{512&t.$$.dirty&&n(5,u=m+1),256&t.$$.dirty&&n(6,a=h+1),30&t.$$.dirty&&n(7,f=Math.min(i/$,c/p)-4+"px"),3072&t.$$.dirty&&null===o&&g(r).catch(t=>{Q.set(1),g(r)}),4096&t.$$.dirty&&(l.length>0?l.reduce((t,e,n)=>t.then(()=>y(e,n===l.length-1)),Promise.resolve()):R.set(null))},[d,p,$,i,c,u,a,f,h,m,r,o,l,g,y,function(){i=this.clientWidth,c=this.clientHeight,n(3,i),n(4,c)}]}class ut extends V{constructor(t){super(),F(this,t,ct,it,l,{})}}function at(e){let n,r,o,l;return{c(){n=p("button"),r=p("img"),r.src!==(o=e[1])&&g(r,"src",o),g(r,"alt",""),g(r,"class","svelte-1mfm20n"),g(n,"title",e[0]),n.disabled=e[3],g(n,"class","svelte-1mfm20n")},m(t,o){a(t,n,o),u(n,r),l=m(n,"click",e[2])},p(t,[e]){2&e&&r.src!==(o=t[1])&&g(r,"src",o),1&e&&g(n,"title",t[0]),8&e&&(n.disabled=t[3])},i:t,o:t,d(t){t&&f(n),l()}}}function ft(t,e,n){let{title:r}=e,{icon:o}=e,{handler:l}=e,{disabled:s=!1}=e;return t.$set=t=>{"title"in t&&n(0,r=t.title),"icon"in t&&n(1,o=t.icon),"handler"in t&&n(2,l=t.handler),"disabled"in t&&n(3,s=t.disabled)},[r,o,l,s]}class dt extends V{constructor(t){super(),F(this,t,ft,at,l,{title:0,icon:1,handler:2,disabled:3})}}function pt(t){let e,n,r;const o=t[1].default,l=function(t,e,n,r){if(t){const o=i(t,e,n,r);return t[0](o)}}(o,t,t[0],null);return{c(){e=p("div"),n=p("div"),l&&l.c(),g(n,"class","window svelte-vsq1ag"),g(e,"class","overlay svelte-vsq1ag")},m(t,o){a(t,e,o),u(e,n),l&&l.m(n,null),r=!0},p(t,[e]){l&&l.p&&1&e&&l.p(i(o,t,t[0],null),function(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if("object"==typeof e.dirty){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(o,t[0],e,null))},i(t){r||(I(l,t),r=!0)},o(t){P(l,t),r=!1},d(t){t&&f(e),l&&l.d(t)}}}function $t(t,e,n){let{$$slots:r={},$$scope:o}=e;return t.$set=t=>{"$$scope"in t&&n(0,o=t.$$scope)},[o,r]}class ht extends V{constructor(t){super(),F(this,t,$t,pt,l,{})}}function mt(t){let e,n,r,o;const l=new dt({props:{title:"Заново",icon:"img/icons/refresh-24px.svg",handler:t[1]}}),s=new dt({props:{title:"Дальше",icon:"img/icons/redo-24px.svg",handler:t[0]}});return{c(){e=p("h1"),e.textContent="Победа!",n=h(),S(l.$$.fragment),r=h(),S(s.$$.fragment),g(e,"class","svelte-14xsa5s")},m(t,i){a(t,e,i),a(t,n,i),B(l,t,i),a(t,r,i),B(s,t,i),o=!0},p(t,[e]){const n={};2&e&&(n.handler=t[1]),l.$set(n);const r={};1&e&&(r.handler=t[0]),s.$set(r)},i(t){o||(I(l.$$.fragment,t),I(s.$$.fragment,t),o=!0)},o(t){P(l.$$.fragment,t),P(s.$$.fragment,t),o=!1},d(t){t&&f(e),t&&f(n),O(l,t),t&&f(r),O(s,t)}}}function gt(t,e,n){let{nextHandler:r}=e,{retryHandler:o}=e;return t.$set=t=>{"nextHandler"in t&&n(0,r=t.nextHandler),"retryHandler"in t&&n(1,o=t.retryHandler)},[r,o]}class yt extends V{constructor(t){super(),F(this,t,gt,mt,l,{nextHandler:0,retryHandler:1})}}function vt(t){let e,n,r;const o=new dt({props:{title:"Заново",icon:"img/icons/refresh-24px.svg",handler:t[0]}});return{c(){e=p("h1"),e.textContent="Ты проиграла!",n=h(),S(o.$$.fragment),g(e,"class","svelte-14xsa5s")},m(t,l){a(t,e,l),a(t,n,l),B(o,t,l),r=!0},p(t,[e]){const n={};1&e&&(n.handler=t[0]),o.$set(n)},i(t){r||(I(o.$$.fragment,t),r=!0)},o(t){P(o.$$.fragment,t),r=!1},d(t){t&&f(e),t&&f(n),O(o,t)}}}function bt(t,e,n){let{retryHandler:r}=e;return t.$set=t=>{"retryHandler"in t&&n(0,r=t.retryHandler)},[r]}class xt extends V{constructor(t){super(),F(this,t,bt,vt,l,{retryHandler:0})}}function wt(t){let e;const n=new ht({props:{$$slots:{default:[zt]},$$scope:{ctx:t}}});return{c(){S(n.$$.fragment)},m(t,r){B(n,t,r),e=!0},p(t,e){const r={};8&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){e||(I(n.$$.fragment,t),e=!0)},o(t){P(n.$$.fragment,t),e=!1},d(t){O(n,t)}}}function Ht(t){let e;const n=new ht({props:{$$slots:{default:[_t]},$$scope:{ctx:t}}});return{c(){S(n.$$.fragment)},m(t,r){B(n,t,r),e=!0},p(t,e){const r={};8&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){e||(I(n.$$.fragment,t),e=!0)},o(t){P(n.$$.fragment,t),e=!1},d(t){O(n,t)}}}function zt(e){let n;const r=new xt({props:{retryHandler:At}});return{c(){S(r.$$.fragment)},m(t,e){B(r,t,e),n=!0},p:t,i(t){n||(I(r.$$.fragment,t),n=!0)},o(t){P(r.$$.fragment,t),n=!1},d(t){O(r,t)}}}function _t(e){let n;const r=new yt({props:{nextHandler:e[1],retryHandler:At}});return{c(){S(r.$$.fragment)},m(t,e){B(r,t,e),n=!0},p:t,i(t){n||(I(r.$$.fragment,t),n=!0)},o(t){P(r.$$.fragment,t),n=!1},d(t){O(r,t)}}}function Ct(t){let e,n,r,o,l,s,i,c;const d=new Z({}),$=new ut({}),m=new dt({props:{title:"Старт",icon:"/img/icons/play_arrow-24px.svg",handler:kt,disabled:"started"===t[0]}}),y=[Ht,wt],v=[];function b(t,e){return"win"===t[0]?0:"lose"===t[0]?1:-1}return~(s=b(t))&&(i=v[s]=y[s](t)),{c(){e=p("main"),S(d.$$.fragment),n=h(),S($.$$.fragment),r=h(),o=p("div"),S(m.$$.fragment),l=h(),i&&i.c(),g(o,"class","start-button svelte-qlkt7z"),g(e,"class","svelte-qlkt7z")},m(t,i){a(t,e,i),B(d,e,null),u(e,n),B($,e,null),u(e,r),u(e,o),B(m,o,null),u(e,l),~s&&v[s].m(e,null),c=!0},p(t,[n]){const r={};1&n&&(r.disabled="started"===t[0]),m.$set(r);let o=s;s=b(t),s===o?~s&&v[s].p(t,n):(i&&(N(),P(v[o],1,1,()=>{v[o]=null}),q()),~s?(i=v[s],i||(i=v[s]=y[s](t),i.c()),I(i,1),i.m(e,null)):i=null)},i(t){c||(I(d.$$.fragment,t),I($.$$.fragment,t),I(m.$$.fragment,t),I(i),c=!0)},o(t){P(d.$$.fragment,t),P($.$$.fragment,t),P(m.$$.fragment,t),P(i),c=!1},d(t){t&&f(e),O(d),O($),O(m),~s&&v[s].d()}}}function kt(){R.set("started")}function At(){R.set(null)}function Et(t,e,n){let r,o;return s(t,Q,t=>n(2,r=t)),s(t,R,t=>n(0,o=t)),t.$$.update=()=>{4&t.$$.dirty&&(document.title=`Уровень ${r}`)},[o,function(){Q.set(r+1),R.set(null)}]}return new class extends V{constructor(t){super(),F(this,t,Et,Ct,l,{})}}({target:document.body,props:{name:"world"}})}();
//# sourceMappingURL=bundle.js.map
